@import 'tailwindcss';
@plugin "@tailwindcss/typography";

@import 'katex/dist/katex.min.css';
@import 'prismjs/themes/prism-tomorrow.css';

@custom-variant dark (&:where([data-theme=dark], [data-theme=dark] *)); /* use data-theme=dark to target dark mode */

:root {
  --bg-button-color: var(--color-slate-200);
  --bg-color: var(--color-white);
  --bg-hover-color: var(--color-slate-100);
  --border-muted-color: var(--color-slate-200);
  --border-button-color: var(--color-slate-300);
  --green-bg-color: var(--color-green-200);
  --green-text-color: var(--color-green-800);
  --link-color: #0285ff;
  --link-hover-color: var(--color-pink-600);
  --muted-color: var(--color-slate-500);
  --text-color: var(--color-slate-800);
  --text-prose-color: var(--color-slate-800);
  --text-heading-color: var(--color-slate-700);
  --yellow-bg-color: var(--color-amber-200);
  --yellow-text-color: #6b5b1c;

  /* Skeletons */
  --skeleton-bg-color: var(--color-slate-200);

  /* Wave colors - light mode (RGB values only, will be used with rgba()) */
  --wave-color-0: 0, 0, 255;
  --wave-color-1: 255, 0, 166;
  --wave-color-2: 0, 0, 0;
  --wave-color-3: 166, 82, 0;
  --wave-color-4: 0, 120, 0;
  --wave-color-5: 166, 0, 82;
  --wave-color-6: 166, 0, 255;
  --wave-color-7: 0, 139, 139;
  --wave-color-8: 0, 200, 255;
  --wave-color-9: 0, 200, 166;
  --wave-color-10: 180, 200, 0;

  --wave-color-alpha-0: 0.2;
  --wave-color-alpha-1: 0.1;
  --wave-color-alpha-2: 0.02;
  --wave-color-alpha-3: 0.03;
}

[data-theme='dark'] {
  --bg-button-color: #23262e;
  --bg-color: #2a2d38;
  --bg-hover-color: #31353f;
  --border-muted-color: #a0a0a01c;
  --border-button-color: #a0a0a05d;
  --green-bg-color: #245833;
  --green-text-color: var(--color-white);
  --link-color: #99ceff;
  --link-hover-color: var(--color-pink-300);
  --muted-color: var(--color-slate-400);
  --text-color: var(--color-slate-50);
  --text-prose-color: var(--color-slate-300);
  --text-heading-color: var(--color-slate-50);
  --yellow-bg-color: #eccd00;
  --yellow-text-color: #4b2f0b;

  /* Skeletons */
  --skeleton-bg-color: var(--color-slate-700);

  /* Wave colors - dark mode (lighter/more visible colors - RGB values only) */
  --wave-color-0: 125, 211, 252; /* sky-300 */
  --wave-color-1: 249, 168, 212; /* pink-300 */
  --wave-color-2: 203, 213, 225; /* slate-300 */
  --wave-color-3: 253, 186, 116; /* orange-300 */
  --wave-color-4: 134, 239, 172; /* green-300 */
  --wave-color-5: 253, 164, 175; /* rose-300 */
  --wave-color-6: 216, 180, 254; /* purple-300 */
  --wave-color-7: 94, 234, 212; /* teal-300 */
  --wave-color-8: 147, 197, 253; /* blue-300 */
  --wave-color-9: 110, 231, 183; /* emerald-300 */
  --wave-color-10: 190, 242, 100; /* lime-300 */

  --wave-color-alpha-0: 0.5;
  --wave-color-alpha-1: 0.2;
  --wave-color-alpha-2: 0.05;
  --wave-color-alpha-3: 0.07;
}

@theme inline {
  --color-bg-button: var(--bg-button-color);
  --color-bg: var(--bg-color);
  --color-bg-hover: var(--bg-hover-color);
  --color-border-muted: var(--border-muted-color);
  --color-border-button: var(--border-button-color);
  --color-green-bg: var(--green-bg-color);
  --color-green-text: var(--green-text-color);
  --color-link: var(--link-color);
  --color-link-hover: var(--link-hover-color);
  --color-muted: var(--muted-color);
  --color-text: var(--text-color);
  --color-text-heading: var(--text-heading-color);
  --color-yellow-bg: var(--yellow-bg-color);
  --color-yellow-text: var(--yellow-text-color);

  /* Skeletons */
  --color-skeleton-bg: var(--skeleton-bg-color);
}

@theme {
  /* Typography */
  --font-heading: Recoleta, Arial, Helvetica, sans-serif;
  --font-sans:
    var(--font-open-sans), ui-sans-serif, system-ui, sans-serif, 'Apple Color Emoji',
    'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  --font-mono:
    ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New',
    monospace;
  --font-quicksand:
    var(--font-quicksand), ui-sans-serif, system-ui, sans-serif, 'Apple Color Emoji',
    'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';

  /* Colors */
  --color-nav-dark-bg: #323541;
  --color-code-dark-bg: #343e4c;

  /* Background Images */
  --background-image-repeating-dots: -webkit-repeating-radial-gradient(
    center center,
    #777,
    #777 1px,
    transparent 0,
    transparent 100%
  );

  /* Animations */
  --animate-fadeIn: fadeIn 500ms;
  --animate-wave: wave 2s linear infinite;
  --animate-toTop: toTop 0.3s alternate ease infinite;
  --animate-dialogOverlayShow: dialogOverlayShow 200ms cubic-bezier(0.16, 1, 0.3, 1);
  --animate-dialogOverlayHide: dialogOverlayHide 200ms cubic-bezier(0.16, 1, 0.3, 1);
  --animate-dialogContentShow: dialogContentShow 200ms cubic-bezier(0.16, 1, 0.3, 1);
  --animate-dialogContentHide: dialogContentHide 200ms cubic-bezier(0.16, 1, 0.3, 1);

  /* Keyframes */
  @keyframes fadeIn {
    0% {
      opacity: 0;
    }
    100% {
      opacity: 1;
    }
  }

  @keyframes wave {
    0% {
      transform: rotate(0deg);
    }
    10% {
      transform: rotate(14deg);
    }
    20% {
      transform: rotate(-8deg);
    }
    30% {
      transform: rotate(14deg);
    }
    40% {
      transform: rotate(-4deg);
    }
    50% {
      transform: rotate(10deg);
    }
    60% {
      transform: rotate(0deg);
    }
    100% {
      transform: rotate(0deg);
    }
  }

  @keyframes toTop {
    0% {
      transform: translate(0, 0);
    }
    100% {
      transform: translate(0, -3px);
    }
  }

  @keyframes dialogOverlayShow {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  @keyframes dialogOverlayHide {
    from {
      opacity: 1;
    }
    to {
      opacity: 0;
    }
  }

  @keyframes dialogContentShow {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  @keyframes dialogContentHide {
    from {
      opacity: 1;
    }
    to {
      opacity: 0;
    }
  }

  /* Letter Spacing */
  --letter-spacing-tighter: -0.04em;

  /* Line Height */
  --line-height-tight: 1.2;

  /* Font Sizes */
  --font-size-5xl: 2.5rem;
  --font-size-6xl: 2.75rem;
  --font-size-7xl: 4.5rem;
  --font-size-8xl: 6.25rem;

  /* Box Shadow */
  --box-shadow-small: 0 5px 10px rgba(0, 0, 0, 0.12);
  --box-shadow-medium: 0 8px 30px rgba(0, 0, 0, 0.12);

  /* Border Radius */
  --radius: 0.5rem;
  --radius-lg: var(--radius);
  --radius-md: calc(var(--radius) - 2px);
  --radius-sm: calc(var(--radius) - 4px);
}

@font-face {
  font-family: 'Recoleta';
  font-weight: 500;
  font-style: normal;
  src: url('./fonts/recoleta/Recoleta-Medium.eot');
  src:
    url('./fonts/recoleta/Recoleta-Medium.woff2') format('woff2'),
    url('./fonts/recoleta/Recoleta-Medium.woff') format('woff'),
    url('./fonts/recoleta/Recoleta-Medium.ttf') format('truetype');
  font-display: swap;
}

@font-face {
  font-family: 'Recoleta';
  src: url('./fonts/recoleta/Recoleta-SemiBold.eot');
  src:
    url('./fonts/recoleta/Recoleta-SemiBold.woff2') format('woff2'),
    url('./fonts/recoleta/Recoleta-SemiBold.woff') format('woff'),
    url('./fonts/recoleta/Recoleta-SemiBold.ttf') format('truetype');
  font-weight: 600;
  font-style: bold;
  font-display: swap;
}

@layer base {
  html {
    font-family: 'font-sans';
    font-size: 16px;
  }

  .thi-scrollbar {
    &::-webkit-scrollbar {
      width: 10px;
      height: 10px;
    }
    &::-webkit-scrollbar-thumb {
      background: #aab5c9b0;
      border-radius: 10px;
      &:hover {
        background: #aab5c9;
      }
    }
    &::-webkit-scrollbar-track {
      background: transparent;
    }

    &.thi-scrollbar-small {
      &::-webkit-scrollbar {
        width: 7px;
        height: 7px;
      }
      &::-webkit-scrollbar-thumb {
        border-radius: 7px;
      }
    }
  }

  /* Hide webkit search cancel button */
  .thi-hide-wscb {
    &::-webkit-search-cancel-button {
      -webkit-appearance: none;
      display: none;
    }
  }
}

@utility prose-pink {
  --tw-prose-body: var(--text-prose-color);
}

@layer utilities {
  /* Custom thi-prose class that extends and customizes the base prose utility */
  /* Placed in @layer utilities to ensure it always comes after base prose styles */
  .thi-prose {
    @apply prose prose-pink max-w-none leading-normal;

    :where(a):not(:where([class~='not-prose'], [class~='not-prose'] *)) {
      font-family: inherit;
      @apply text-link hover:text-link-hover no-underline;
    }

    :where(h1, h2, h3, h4, h5, h6):not(:where([class~='not-prose'], [class~='not-prose'] *)) {
      @apply text-text-heading my-0 font-semibold;
      font-family: var(--font-quicksand), ui-sans-serif, system-ui, sans-serif !important;
      font-weight: 500;
      opacity: 0.9;
    }

    :where(h1):not(:where([class~='not-prose'], [class~='not-prose'] *)) {
      font-size: 1.55rem;
    }

    :where(h2):not(:where([class~='not-prose'], [class~='not-prose'] *)) {
      font-size: 1.45rem;
    }

    :where(h3):not(:where([class~='not-prose'], [class~='not-prose'] *)) {
      font-size: 1.35rem;
    }

    /* Mobile styles */
    @media (max-width: 768px) {
      :where(h1):not(:where([class~='not-prose'], [class~='not-prose'] *)) {
        font-size: 1.45rem;
      }
      :where(h2):not(:where([class~='not-prose'], [class~='not-prose'] *)) {
        font-size: 1.3rem;
      }
      :where(h3):not(:where([class~='not-prose'], [class~='not-prose'] *)) {
        font-size: 1.2rem;
      }
    }

    :where(img):not(:where([class~='not-prose'], [class~='not-prose'] *)) {
      @apply my-0;
    }

    :where(blockquote):not(:where([class~='not-prose'], [class~='not-prose'] *)) {
      font-family: inherit;
      @apply my-3 py-3 text-inherit not-italic;
      border-top: 0 !important;
      border-bottom: 0 !important;
      border-right: 0 !important;
      border-left: 4px solid rgb(100 116 139) !important; /* slate-500 */
    }

    :where(code):not(:where([class~='not-prose'], [class~='not-prose'] *)) {
      @apply rounded-md bg-gray-200 p-[1px_8px_2px_6px] font-mono text-[90%] font-normal wrap-break-word before:content-[''] after:content-[''] dark:bg-[#343434] dark:text-[#ff9293];
    }

    :where(li):not(:where([class~='not-prose'], [class~='not-prose'] *)) {
      @apply my-1.5;
    }

    :where(ol):not(:where([class~='not-prose'], [class~='not-prose'] *)) {
      @apply my-0;
    }

    :where(ul):not(:where([class~='not-prose'], [class~='not-prose'] *)) {
      @apply my-0;
    }

    :where(td):not(:where([class~='not-prose'], [class~='not-prose'] *)) {
      @apply px-[10px] py-[5px];
    }

    :where(hr):not(:where([class~='not-prose'], [class~='not-prose'] *)) {
      @apply border-border-muted my-6;
    }

    :where(figure):not(:where([class~='not-prose'], [class~='not-prose'] *)) {
      margin: 0.75rem 0;
    }

    :where(strong, b):not(:where([class~='not-prose'], [class~='not-prose'] *)) {
      @apply font-semibold text-inherit dark:text-white;
    }

    /* Keep link color when strong/b is inside <a> or <a> is inside strong/b */
    :where(a strong, a b, strong a, b a):not(:where([class~='not-prose'], [class~='not-prose'] *)) {
      @apply text-link hover:text-link-hover font-semibold;
    }

    :where(table):not(:where([class~='not-prose'], [class~='not-prose'] *)) {
      @apply my-0;
    }

    /* There is a strange problem where ul inside ol or ol inside ul: */
    /* normally, we should have ol > ul but rendered as ol > ol > ul */
    /* -1.625em is the opposite of the default margin-left of padding-inline-start of an ul/ol given */
    /* by prose class */
    :where(ol > ol > ul):not(:where([class~='not-prose'], [class~='not-prose'] *)),
    :where(ul > ul > ol):not(:where([class~='not-prose'], [class~='not-prose'] *)) {
      margin-left: -1.625em;
    }

    :where(ul, ol):not(:where([class~='not-prose'], [class~='not-prose'] *)) {
      & > *:not(ul):not(ol) {
        margin-top: 0.5rem !important;
        margin-bottom: 0.5rem !important;
      }
    }

    :where(ul > li::marker):not(:where([class~='not-prose'], [class~='not-prose'] *)) {
      font-size: 1rem;
    }
  }
}

@layer components {
  .thi-text-rainbow {
    @apply bg-linear-to-r from-[#ff88c3] to-violet-400 bg-clip-text text-transparent;
  }
}

ol,
ul {
  ol > .button-indicator,
  ul > .button-indicator {
    display: none !important;
  }
}

code {
  .linenumber {
    font-size: 0.7rem;
  }
}

.table_block_column_header {
  tr:first-child {
    @apply bg-gray-100 font-semibold dark:bg-bg;
  }
}

.table_block_row_header {
  tr {
    td:first-child {
      @apply bg-gray-100 font-semibold dark:bg-bg;
    }
  }
}

/* Notion background colors */
@layer base {
  .notion-gray_background {
    @apply bg-gray-100 dark:bg-gray-600/70;
  }

  .notion-gray_background,
  .bg-gray-100 {
    .toggle-container {
      background-color: rgb(249 250 251); /* bg-gray-50 */
    }

    .toggle-button {
      &.toggle-open,
      &:hover {
        background-color: rgb(229 231 235); /* bg-gray-200 */
      }
    }
  }

  .notion-brown_background {
    @apply bg-[#ebc79e] dark:bg-[#7b5e3c];
  }

  .notion-orange_background {
    @apply bg-orange-200/60 dark:bg-orange-400/20;
  }

  .notion-yellow_background {
    @apply bg-yellow-200/60 dark:bg-yellow-500/20;
  }

  .notion-teal_background,
  .notion-green_background {
    @apply bg-[#deffdb] dark:bg-green-700/20;
  }

  .notion-blue_background {
    @apply bg-sky-100 dark:bg-blue-400/20;
  }

  .notion-purple_background {
    @apply bg-purple-100 dark:bg-purple-400/20;
  }

  .notion-pink_background {
    @apply bg-pink-100 dark:bg-pink-400/20;
  }

  .notion-red_background {
    @apply bg-red-100 dark:bg-red-400/20;
  }

  /* Text */
  .notion-gray {
    @apply text-gray-500 dark:text-gray-400;
  }

  .notion-brown {
    @apply text-[#9f6b53];
  }

  .notion-orange {
    @apply text-orange-500;
  }

  .notion-yellow {
    @apply text-amber-500;
  }

  .notion-teal {
    @apply text-teal-600;
  }

  .notion-blue {
    @apply text-blue-500;
  }

  .notion-purple {
    @apply text-purple-500;
  }

  .notion-pink {
    @apply text-pink-500 dark:text-pink-400;
  }

  .notion-red {
    @apply text-red-500;
  }

  .notion-gray,
  .notion-brown,
  .notion-orange,
  .notion-yellow,
  .notion-teal,
  .notion-blue,
  .notion-purple,
  .notion-pink,
  .notion-red {
    strong {
      color: inherit;
    }
  }
}

/* List styling enhancements */
ul > ul > li,
ol > ul > li {
  list-style-type: circle;
}

ul > ul > ul > li {
  list-style-type: square;
}

ol,
ul {
  & > *:not(li):not(ol):not(ul):not(button.updated-block) {
    margin-left: -1.5rem !important;
  }
}

ol > ol,
ul > ul {
  & > .toggle-container {
    margin-left: -1.7rem !important;
  }
}

.katex-display {
  margin: 0;

  .katex-html {
    white-space: normal;
    line-height: 1.5;
  }
}

/* fix overflow auto numbering from \begin{equation} */
.katex .vlist-t2 {
  margin-right: 0 !important;
}

ul > li {
  padding-left: 0 !important;
  &::marker {
    font-size: 1.25rem;
  }
}

.quote-children {
  & > * {
    margin-top: 0.75rem !important;
    &:not(:last-child) {
      margin-bottom: 0.75rem !important;
    }
    &:last-child {
      margin-bottom: 0 !important;
      & > *:last-child {
        margin-bottom: 0 !important;
        & > *:last-child {
          margin-bottom: 0 !important;
        }
      }
    }
  }
}

.notion-page-icon-inline {
  width: 26px;

  img {
    margin-top: 5px;
  }
}

.notion-page-icon-hero {
  flex-shrink: 0;
  width: 50px;
  height: 50px;
  font-size: 50px;
  line-height: 1;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Copied from notion-nextjs-lib */
.w-full > iframe {
  width: 100%;
  height: -webkit-fill-available;
}

.no-scrollbar::-webkit-scrollbar {
  display: none;
}

.notion-h-title {
  .katex {
    font-size: 105%;
  }
}

.katex {
  font-size: 115%;
}

.tooltip-auto {
  position: relative;

  &:not(&:hover) {
    z-index: 0;
  }

  &:hover {
    z-index: 1;
    &:before {
      opacity: 1;
    }
  }

  &:before {
    display: block;
    opacity: 0;
    pointer-events: none;
    position: absolute;
    background: #000;
    border-radius: 5px;
    color: #fff;
    content: attr(data-title);
    font-size: 0.85rem;
    padding: 2px 8px;
    line-height: 1.5;
    top: 120%;
    height: fit-content;
    white-space: break-spaces;
    width: max-content;
    max-width: 250px;
    letter-spacing: 0.5px;
    font-weight: normal;
  }

  &:not(._from-right):before {
    left: 5px;
  }

  &._from-right {
    &:before {
      left: auto;
      right: 5px;
    }
  }
}

.heading-container + .heading-container {
  margin-top: 1.25rem;
}

.notion-link {
  strong {
    color: var(--link-color) !important;
  }
  &:hover {
    strong {
      color: var(--link-hover-color) !important;
    }
  }
}

pre > code::before {
  margin-left: -5px !important;
}

.post-card-wave {
  background: #fff;
  box-shadow:
    8px 14px 38px #272c310f,
    1px 3px 8px #272c3108;
  height: 100%;
  min-height: 8rem;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  padding: 1rem;
  border-radius: 12px;
  transition: all 0.3s ease-in-out;
  position: relative;
  overflow: hidden;
}

.circle-wave {
  position: relative;
  overflow: hidden;
}

.bottom-wave {
  position: absolute;
  bottom: -2px;
  width: 100%;

  .waves {
    position: relative;
    width: 100%;
    height: 5vh;
    margin-bottom: -7px; /*Fix for safari gap*/
    min-height: 60px;
    max-height: 150px;

    .parallax > use {
      animation: move-forever 25s cubic-bezier(0.55, 0.5, 0.45, 0.5) infinite;
    }
    .parallax > use:nth-child(1) {
      animation-delay: -2s;
      animation-duration: 10s;
    }
    .parallax > use:nth-child(2) {
      animation-delay: -5s;
      animation-duration: 10s;
    }
    .parallax > use:nth-child(3) {
      animation-delay: -7s;
      animation-duration: 10s;
    }
    .parallax > use:nth-child(4) {
      animation-delay: -1s;
      animation-duration: 10s;
    }
  }
}

@keyframes move-forever {
  0% {
    transform: translate3d(-90px, 0, 0);
  }
  100% {
    transform: translate3d(85px, 0, 0);
  }
}

.toggle-heading-content-container {
  & > * {
    &:last-child {
      margin-bottom: 0;
    }
  }

  li:last-of-type {
    margin-bottom: 0;
  }
}

.inside-toggle-container {
  .block-column-list {
    margin: -0.75rem 0 !important;
  }
}
