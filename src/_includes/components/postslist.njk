{#
  Parameters:
  - postslist
  - morePosts
  - customClass (string)
  - sortBy ('date')
  - limitPosts (number)
  - customIcon (boolean)
  - hideBlogPosts (boolean)
#}

<div class="toggle-posts{% if customClass %} {{ customClass }}{% endif %}">

  {% set newPostList = [] %}
  {% for post in postslist %}
    {% set singlePost = {
      'title': post.data.title,
      'url': post.url,
      'date': post.date,
      'isBlog': post.data.tags | isBlog
    } %}
    {% if post.data.notfull %}
      {% set singlePost = singlePost | setAttribute('notfull', post.data.notfull) %}
    {% endif %}
    {% if post.data.lowQuality %}
      {% set singlePost = singlePost | setAttribute('lowQuality', post.data.lowQuality) %}
    {% endif %}
    {% if post.data.private %}
      {% set singlePost = singlePost | setAttribute('private', post.data.private) %}
    {% endif %}
    {# {% if post.data.good %}
      {% set singlePost = singlePost | setAttribute('good', post.data.good) %}
    {% endif %} #}
    {% if not post.data.hide %}
      {% set newPostList = (newPostList.push(singlePost), newPostList) %}
    {% endif %}
  {% endfor %}

  {% if morePosts %}
    {% for post in morePosts %}
      {% set singlePost = {
        'title': post.title,
        'url': post.url,
        'target': "_blank",
        'external': true,
        'date': post.date,
        'isBlog': post.tags | isBlog
      } %}
      {% if post.notfull %}
        {% set singlePost = singlePost | setAttribute('notfull', post.notfull) %}
      {% endif %}
      {% if post.lowQuality %}
        {% set singlePost = singlePost | setAttribute('lowQuality', post.lowQuality) %}
      {% endif %}
      {% if post.private %}
        {% set singlePost = singlePost | setAttribute('private', post.private) %}
      {% endif %}
      {% if not post.hide %}
        {% set newPostList = (newPostList.push(singlePost), newPostList) %}
      {% endif %}
    {% endfor %}
  {% endif %}

  {% if sortBy == 'date' %}
    {% set newPostList = newPostList | sort(attribute = 'date') | reverse %}
  {% else %}
    {% set newPostList = newPostList | sort(attribute = 'title') %}
  {% endif %}

  {% if limitPosts %}
    {% set newPostList = newPostList | head(limitPosts) %}
  {% endif %}

  {% for post in newPostList %}
    {% if not hideBlogPosts or not post.isBlog  %}
      {% if post.target %}
        {% set target = post.target %}
      {% else %}
        {% set target = "_self" %}
      {% endif%}
      {% if 'list-of-blog' in customClass %}
        <a href="{{ post.url | url }}" rel="noopener noreferrer" target="{{ target }}">
      {% endif %}
      <div class="post-item
        {% if post.notfull or post.lowQuality %} post-not-full{% endif %}
        {% if post.private %} post-private{% endif %}
        {% if post.external %} post-outside{% endif %}
      ">
        {% if customIcon %}
          {% if post.isBlog %}
            {% set blogItem = categories | getBlog %}
            <i class="{{ blogItem.fontello }} fontello-icon" style="color: {{ blogItem.color }};"></i>
          {% else %}
            {% if not post.external %}
              <i class="icon-doc fontello-icon"></i>
            {% else %}
              <i class="icon-doc-add fontello-icon"></i>
            {% endif %}
          {% endif %}
        {% endif %}

        {% if not 'list-of-blog' in customClass %}<a href="{{ post.url | url }}" rel="noopener noreferrer" target="{{ target }}">{% endif %}
          {% if post.title %}
            {{ post.title }}
            {# {% if post.good %}
              <sup title="{{ other_data.good }}" style="color: #ffc50b;">⭑</sup>
            {% endif %} #}
            {% if post.notfull or post.lowQuality %}
              <sup title="{{ other_data.notfull }}">•</sup>
            {% endif %}
            {% if post.private %}
              <sup title="{{ other_data.private }}">†</sup>
            {% endif %}
          {% else %}
            <code>{{ post.url }}</code>
            {% if post.notfull or post.lowQuality %}
              <sup title="{{ other_data.notfull }}">•</sup>
            {% endif %}
            {% if post.private %}
              <sup title="{{ other_data.private }}">†</sup>
            {% endif %}
          {% endif %}
        {% if not 'list-of-blog' in customClass %}
          </a>{% if post.date and showDate %} — <span class="last-modified">{{ post.date | toDuration }}</span>{% endif %}
        {% endif %}
      </div>
      {% if 'list-of-blog' in customClass %}</a>{% endif %}
      {# <time  datetime="{{ post.date | htmlDateString }}">{{ post.date | readableDate }}</time> #}
    {% endif %}
  {% endfor %}
</div>